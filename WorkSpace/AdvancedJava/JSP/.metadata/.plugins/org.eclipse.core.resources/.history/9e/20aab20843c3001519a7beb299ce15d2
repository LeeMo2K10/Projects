<%@ page session="false" %>
<%@ page import="java.sql.*" %>
<%@ page import="java.util.*" %>
<%@ page import="java.lang.reflect.*" %>
<%
String driverName = request.getParameter("driverName");
if (driverName == null)
driverName = "";
driverName = driverName.trim();
if (driverName.equals(""))
throw new ServletException("No driverName parameter");
// Get required database URL parameter
String url = request.getParameter("url");
if (url == null)
url = "";
url = url.trim();
if (url.equals(""))
throw new ServletException("No url parameter");
// Get optional userID parameter
String userID = request.getParameter("userID");
if (userID == null)
userID = "";
userID = userID.trim();
// Get optional password parameter
String password = request.getParameter("password");
if (password == null)
password = "";
password = password.trim();
// Load the driver
Class.forName(driverName);
Connection con = null;
try {
// Open the database connection and get the metadata
con = DriverManager.getConnection(url, userID, password);
DatabaseMetaData md = con.getMetaData();
/*
Use reflection to get a list of methods that the
metadata class supports. Select only public methods
that take no parameters and that return either
a string or a boolean.*/
Class mdclass = md.getClass();
Method[] methods = mdclass.getDeclaredMethods();
Map methodMap = new TreeMap();
for (int i = 0; i < methods.length; i++) {
Method method = methods[i];
// Public methods only
if (!Modifier.isPublic(method.getModifiers()))
continue;
// with no parameters
if (method.getParameterTypes().length > 0)
continue;
// that return String or boolean

Class returnType = method.getReturnType();
if ((returnType != java.lang.Boolean.TYPE) &&
(returnType != java.lang.String.class))
continue;
// Add selected methods to sorted map
methodMap.put(method.getName(), method);
}
int row = 0;
Iterator im = methodMap.keySet().iterator();
while (im.hasNext()) {
String methodName = (String) im.next();
Object methodValue = null;
Method method = (Method) methodMap.get(methodName);
// Invoke the method and get the result
%>
<HTML>
<HEAD>
<TITLE>Metadata Explorer</TITLE>
<LINK REL="stylesheet" HREF="style.css">
</HEAD>
<BODY>
<CENTER>
<H3>
Metadata Explorer for
<%= md.getDatabaseProductName() %>
<%= md.getDatabaseProductVersion() %>
<BR>
[<%= driverName %>]
</H3>
<TABLE BORDER=0 CELLPADDING=3 CELLSPACING=1>
<TR CLASS="header">
<TH CLASS="header">Method</TH>
<TH CLASS="header">Value</TH>
</TR>
<%
int row = 0;
Iterator im = methodMap.keySet().iterator();
while (im.hasNext()) {
String methodName = (String) im.next();
Object methodValue = null;
Method method = (Method) methodMap.get(methodName);
// Invoke the method and get the result