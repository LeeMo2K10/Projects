package com.sqoop;

import org.apache.sqoop.client.SqoopClient;

import org.apache.sqoop.model.MLink;
import org.apache.sqoop.model.MLinkConfig;
import org.apache.sqoop.validation.Status;

public class LinkCreation extends SqoopClient {
	String url = "http://localhost:12000/sqoop/";
	SqoopClient client = new SqoopClient(url);

	public LinkCreation(String serverUrl) {
		super(serverUrl);

	}

	public void test() {
		long connectorId = 1;
		MLink link = client.createLink(connectorId);
		link.setName("Vampire");
		link.setCreationUser("Buffy");
		MLinkConfig linkConfig = link.getConnectorLinkConfig();
		// fill in the link config values
		linkConfig.getStringInput("linkConfig.connectionString").setValue("jdbc:mysql://localhost/my");
		linkConfig.getStringInput("linkConfig.jdbcDriver").setValue("com.mysql.jdbc.Driver");
		linkConfig.getStringInput("linkConfig.username").setValue("root");
		linkConfig.getStringInput("linkConfig.password").setValue("root");
		Status status = client.saveLink(link);
		if (status.canProceed()) {
			System.out.println("Created Link with Link Id : " + link.getPersistenceId());
		} else {
			System.out.println("Something went wrong creating the link");
		}
	}public static void main(String[] args) {
		String url = "http://192.168.1.146:12000/sqoop/";
		LinkCreation link1=new LinkCreation(url);
	}
}