package com.oozie.coordinator;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.Properties;

import org.apache.oozie.client.CoordinatorJob;
import org.apache.oozie.client.OozieClient;
import org.apache.oozie.client.OozieClientException;
import org.apache.oozie.client.Job.Status;

public class CoordinatorSample {
	OozieClient wc = null;

	public CoordinatorSample(String oozieUrl) {
		wc = new OozieClient(oozieUrl);
	}

	public String submitJob(String jobPropertyFilePath)
			throws FileNotFoundException, IOException, OozieClientException {
		Properties props = wc.createConfiguration();
		props.setProperty("user.name", "chinna");
		props.load(new FileInputStream(jobPropertyFilePath));

		return wc.submit(props);
	}

	public String submitJob(Properties workflowProperties) throws OozieClientException, IOException {
		Properties conf = wc.createConfiguration();
		conf.putAll(workflowProperties);
		conf.setProperty("user.name", "training");
		return wc.submit(conf);
	}

	public String runJob(String jobPropertyFilePath) throws OozieClientException, IOException {

		Properties conf = wc.createConfiguration();
		conf.setProperty("user.name", "chinna");
		conf.load(new FileInputStream(jobPropertyFilePath));
		return wc.run(conf);
	}

	public void suspendJob(String jobId) throws OozieClientException {
		wc.suspend(jobId);
	}

	public void resumeJob(String jobId) throws OozieClientException {
		wc.resume(jobId);
	}

	public void killJob(String jobId) throws OozieClientException {
		wc.kill(jobId);
	}

	public Status getJobStatus(String jobID) throws OozieClientException {
		CoordinatorJob job = wc.getCoordJobInfo(jobID);
		return job.getStatus();
	}
}
