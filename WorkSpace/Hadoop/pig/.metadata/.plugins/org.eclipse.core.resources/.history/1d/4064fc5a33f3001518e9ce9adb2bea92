package com.myudfs;

import java.io.IOException;

import org.apache.pig.Algebraic;
import org.apache.pig.EvalFunc;
import org.apache.pig.backend.executionengine.ExecException;
import org.apache.pig.builtin.AlgebraicBigDecimalMathBase.Final;
import org.apache.pig.builtin.AlgebraicByteArrayMathBase.Initial;
import org.apache.pig.builtin.COR.Intermed;
import org.apache.pig.data.DataBag;
import org.apache.pig.data.Tuple;

public class Count extends EvalFunc<Long> implements Algebraic {

	public String getFinal() {

		return Final.class.getName();
	}

	public String getInitial() {

		return Initial.class.getName();
	}

	public String getIntermed() {

		return Intermed.class.getName();
	}

	@Override
	public Long exec(Tuple tuple) throws IOException {

		return count(tuple);
	}

	static protected Long count(Tuple tuple) throws ExecException {
		Object values = tuple.get(0);
		if (values instanceof DataBag)

			return ((DataBag) values).size();
		return null;
	}

}
